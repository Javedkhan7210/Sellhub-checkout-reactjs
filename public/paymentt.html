<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://tap-sdks.b-cdn.net/card/1.0.2/index.js"></script>
    <title>Tap Card Payment</title>
    <style>
      body {
        background-color: #0b0b0e;
        color: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        /* min-height: 100vh; */
        font-family: sans-serif;
      }
      #card-sdk-id {
        max-width: 500px;
        width: 100%;
        background-color: #0b0b0e;
      }
    </style>
  </head>
  <body>
    <div id="card-sdk-id"></div>

    <script>
      const {
        renderTapCard,
        Theme,
        Currencies,
        Direction,
        Edges,
        Locale,
      } = window.CardSDK;

      const { unmount } = renderTapCard("card-sdk-id", {
        publicKey: "pk_test_yJ5QwkWvqTHKOBVxFZstPECp",
        merchant: {
          id: "52502637",
        },
        transaction: {
          amount: 1,
          currency: Currencies.AED,
        },
   
        acceptance: {
          supportedBrands: ["AMERICAN_EXPRESS", "VISA", "MASTERCARD", "MADA"],
          supportedCards: "ALL",
        },
        fields: {
          cardHolder: true,
        },
        addons: {
          displayPaymentBrands: false,
          loader: true,
          saveCard: true,
        },
        interface: {
          locale: Locale.EN,
          theme: Theme.LIGHT,
          edges: Edges.CURVED,
          direction: Direction.LTR,
        },
        onReady: () => {
          console.log("onReady");

          // Wait and inject custom styles into iframe
          const observer = new MutationObserver(() => {
            const iframe = document.querySelector("#card-sdk-id iframe");
            if (iframe && iframe.contentWindow?.document?.body) {
              try {
                const css = `
                  input, .field {
                    background: red !important;
                    color: black !important;
                    border: 1px solid red !important;
                    border-radius: 6px !important;
                    padding: 10px !important;
                  }
                `;
                const style = iframe.contentDocument.createElement("style");
                style.innerHTML = css;
                iframe.contentDocument.head.appendChild(style);
                observer.disconnect(); // Stop watching after injecting
              } catch (e) {
                console.warn("Failed to inject styles into iframe:", e);
              }
            }
          });

          observer.observe(document.getElementById("card-sdk-id"), {
            childList: true,
            subtree: true,
          });
        },
        onError: (data) => console.log("onError", data),
        onSuccess: (data) => {
  console.log("onSuccess", data);

  // Assuming `data` has an `id` field
  if (data?.id) {
    sessionStorage.setItem("tap_payment_id", data.id);
  }
}
        // onSuccess: (data) => console.log("onSuccess", data),
      });
    </script>
  </body>
</html>
